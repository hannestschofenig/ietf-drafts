<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>AES Counter Mode Cipher Suites for TLS and DTLS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="AES Counter Mode Cipher Suites for TLS and DTLS">
<meta name="generator" content="xml2rfc v1.30 (http://xml.resource.org/)">
<style type='text/css'>
<!--
    body {
        font-family: verdana, charcoal, helvetica, arial, sans-serif;
        margin: 2em;
        font-size: small ; color: #000000 ; background-color: #ffffff ; }
    .title { color: #990000; font-size: x-large ;
        font-weight: bold; text-align: right;
        font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
        background-color: transparent; }
    .filename { color: #666666; font-size: 18px; line-height: 28px;
        font-weight: bold; text-align: right;
        font-family: helvetica, arial, sans-serif;
        background-color: transparent; }
    td.rfcbug { background-color: #000000 ; width: 30px ; height: 30px ;
        text-align: justify; vertical-align: middle ; padding-top: 2px ; }
    td.rfcbug span.RFC { color: #666666; font-weight: bold; text-decoration: none;
        background-color: #000000 ;
        font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
        font-size: x-small ; }
    td.rfcbug span.hotText { color: #ffffff; font-weight: normal; text-decoration: none;
        text-align: center ;
        font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
        font-size: x-small ; background-color: #000000; }
    /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
    div#counter{margin-top: 100px}

    a.info{
        position:relative; /*this is the key*/
        z-index:24;
        text-decoration:none}

    a.info:hover{z-index:25; background-color:#990000 ; color: #ffffff ;}

    a.info span{display: none}

    a.info:hover span.info{ /*the span will display just on :hover state*/
        display:block;
        position:absolute;
        font-size: smaller ;
        top:2em; left:2em; width:15em;
        padding: 2px ;
        border:1px solid #333333;
        background-color:#eeeeee; color:#990000;
        text-align: left ;}

     A { font-weight: bold; }
     A:link { color: #990000; background-color: transparent ; }
     A:visited { color: #333333; background-color: transparent ; }
     A:active { color: #333333; background-color: transparent ; }

    p { margin-left: 2em; margin-right: 2em; }
    p.copyright { font-size: x-small ; }
    p.toc { font-size: small ; font-weight: bold ; margin-left: 3em ;}
    table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
    td.toc { font-size: small; font-weight: bold; vertical-align: text-top; }

    span.emph { font-style: italic; }
    span.strong { font-weight: bold; }
    span.verb, span.vbare { font-family: "Courier New", Courier, monospace ; }

    span.vemph { font-style: italic; font-family: "Courier New", Courier, monospace ; }
    span.vstrong { font-weight: bold; font-family: "Courier New", Courier, monospace ; }
    span.vdeluxe { font-weight: bold; font-style: italic; font-family: "Courier New", Courier, monospace ; }

    ol.text { margin-left: 2em; margin-right: 2em; }
    ul.text { margin-left: 2em; margin-right: 2em; }
    li { margin-left: 3em;  }

    pre { margin-left: 3em; color: #333333;  background-color: transparent;
        font-family: "Courier New", Courier, monospace ; font-size: small ;
        text-align: left;
        }

    h3 { color: #333333; font-size: medium ;
        font-family: helvetica, arial, sans-serif ;
        background-color: transparent; }
    h4 { font-size: small; font-family: helvetica, arial, sans-serif ; }

    table.bug { width: 30px ; height: 15px ; }
    td.bug { color: #ffffff ; background-color: #990000 ;
        text-align: center ; width: 30px ; height: 15px ;
         }
    td.bug A.link2 { color: #ffffff ; font-weight: bold;
        text-decoration: none;
        font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
        font-size: x-small ; background-color: transparent }

    td.header { color: #ffffff; font-size: x-small ;
        font-family: arial, helvetica, sans-serif; vertical-align: top;
        background-color: #666666 ; width: 33% ; }
    td.author { font-weight: bold; margin-left: 4em; font-size: x-small ; }
    td.author-text { font-size: x-small; }
    table.full { vertical-align: top ; border-collapse: collapse ;
        border-style: solid solid solid solid ;
        border-color: black black black black ;
        font-size: small ; text-align: center ; }
    table.headers, table.none { vertical-align: top ; border-collapse: collapse ;
        border-style: none;
        font-size: small ; text-align: center ; }
    table.full th { font-weight: bold ;
        border-style: solid ;
        border-color: black black black black ; }
    table.headers th { font-weight: bold ;
        border-style: none none solid none;
        border-color: black black black black ; }
    table.none th { font-weight: bold ;
        border-style: none; }
    table.full td {
        border-style: solid solid solid solid ;
        border-color: #333333 #333333 #333333 #333333 ; }
    table.headers td, table.none td { border-style: none; }

    hr { height: 1px }
-->
</style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">N. Modadugu</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Stanford University</td></tr>
<tr><td class="header">Expires: August 30, 2006</td><td class="header">E. Rescorla</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Network Resonance</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">February 26, 2006</td></tr>
</table></td></tr></table>
<div align="right"><span class="title"><br />AES Counter Mode Cipher Suites for TLS and DTLS</span></div>
<div align="right"><span class="title"><br />draft-ietf-tls-ctr-00.txt</span></div>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on August 30, 2006.</p>

<h3>Copyright Notice</h3>
<p>
Copyright &copy; The Internet Society (2006).</p>

<h3>Abstract</h3>

<p>
  This document describes the use of the Advanced Encryption Standard
  (AES) Counter Mode for use as a Transport Layer Security (TLS) and
  Datagram Transport Layer Security (DTLS) confidentiality mechanism.
  
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Conventions Used In This Document<br />
<a href="#anchor3">2.</a>&nbsp;
Terminology<br />
<a href="#anchor4">3.</a>&nbsp;
Encrypting Records with AES Counter Mode<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.1.</a>&nbsp;
TLS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.1.1.</a>&nbsp;
AES Counter Mode<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.2.</a>&nbsp;
DTLS<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.3.</a>&nbsp;
Padding<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.4.</a>&nbsp;
Session Resumption<br />
<a href="#anchor10">4.</a>&nbsp;
Design Rationale<br />
<a href="#anchor11">5.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">5.1.</a>&nbsp;
Maximum Key Lifetime<br />
<a href="#anchor13">6.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">7.</a>&nbsp;
Normative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;Introduction</h3>

<p>
  Transport Layer Security <a class="info" href="#I-D.ietf-tls-rfc2246-bis">[3]<span> (</span><span class="info">Dierks, T. and E. Rescorla, &ldquo;The TLS Protocol Version 1.1,&rdquo; June&nbsp;2005.</span><span>)</span></a> provides
  channel-oriented security for application layer protocols. In TLS,
  cryptographic algorithms are specified in "Cipher Suites, which
  consist of a group of algorithms to be used together."
  
</p>
<p>
  Cipher suites supported by TLS are divided into stream and block
  ciphers.  Counter mode ciphers behave like stream ciphers, but are
  constructed based on a block cipher primitive (that is, counter mode
  operation of a block cipher results in a stream cipher.)  This
  specification is limited to discussion of the operation of AES in
  counter mode (AES-CTR.)
  
</p>
<p>
  Counter mode ciphers (CTR) offer a number of attractive features
  over other block cipher modes and stream ciphers such as RC4:
  
</p>
<p>
  </p>
<blockquote class="text"><dl>
<dt>Low Bandwidth:</dt>
<dd> AES-CTR provides a saving of 17-32
    bytes per record compared to AES-CBC as used in TLS 1.1 and DTLS.
    16 bytes are saved from not having to transmit an explicit IV, and
    another 1-16 bytes are saved from the absence of the padding block.
    <br />

    
</dd>
<dt>Random Access:</dt>
<dd> AES-CTR is capable of random access
    within the key stream.  For DTLS, this implies that records can be
    processed out of order without dependency on packet arrival order,
    and also without keystream buffering.
    <br />

    
</dd>
<dt>Parallelizable:</dt>
<dd> As a consequence of AES-CTR
    supporting random access within the key stream, the cipher can be
    easily parallelized.
    <br />

    
</dd>
<dt>Multiple mode support:</dt>
<dd> AES-CTR support in TLS/DTLS
    allows for implementator to support both a stream (CTR) and block (CBC)
    cipher
    through the implemention of a single symmetric algorithm.
    
</dd>
</dl></blockquote><p>
  
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;Conventions Used In This Document</h3>

<p>
  The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
  "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
  document are to be interpreted as described in <a class="info" href="#RFC2119">[1]<span> (</span><span class="info">Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
  
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;Terminology</h3>

<p>
  This document reuses some terminology introduced in <a class="info" href="#RFC3686">[2]<span> (</span><span class="info">Housley, R., &ldquo;Using Advanced Encryption Standard (AES) Counter Mode With IPsec Encapsulating Security Payload (ESP),&rdquo; January&nbsp;2004.</span><span>)</span></a> and <a class="info" href="#I-D.ietf-tls-rfc2246-bis">[3]<span> (</span><span class="info">Dierks, T. and E. Rescorla, &ldquo;The TLS Protocol Version 1.1,&rdquo; June&nbsp;2005.</span><span>)</span></a>.
  The term 'counter block' has the same meaning as used in RFC3686,
  however, the term 'IV', in this document, holds the meaning defined
  in <a class="info" href="#I-D.ietf-tls-rfc2246-bis">[3]<span> (</span><span class="info">Dierks, T. and E. Rescorla, &ldquo;The TLS Protocol Version 1.1,&rdquo; June&nbsp;2005.</span><span>)</span></a>.
  
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;Encrypting Records with AES Counter Mode</h3>

<p>
  The use of AES-CTR in TLS/DTLS turns out to be fairly
  straightforward, with the additional benefit that the method of
  operation in TLS/DTLS mimics, to a large extent, that in IPsec.  The
  primary constraint on the use of counter mode ciphers is that for a
  given key, a counter block value MUST never be used more than once
  (see Section 7 of <a class="info" href="#RFC3686">[2]<span> (</span><span class="info">Housley, R., &ldquo;Using Advanced Encryption Standard (AES) Counter Mode With IPsec Encapsulating Security Payload (ESP),&rdquo; January&nbsp;2004.</span><span>)</span></a> for a detailed
  explanation.)  In TLS/DTLS ensuring that counter block values never
  repeat during a given session is straightforward as explained in the
  following sections.
  
</p>
<p>
  SSL/TLS records encrypted with AES-CTR mode use a
  CipherSpec.cipher_type of GenericStreamCipher (Section 6.2.3 of
  <a class="info" href="#I-D.ietf-tls-rfc2246-bis">[3]<span> (</span><span class="info">Dierks, T. and E. Rescorla, &ldquo;The TLS Protocol Version 1.1,&rdquo; June&nbsp;2005.</span><span>)</span></a>).
  
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;TLS</h3>

<p>
    The cipher stream generated by AES-CTR is much like the cipher
    stream generated by stream ciphers like RC4.  For reasons
    described in Section 7 of <a class="info" href="#RFC3686">[2]<span> (</span><span class="info">Housley, R., &ldquo;Using Advanced Encryption Standard (AES) Counter Mode With IPsec Encapsulating Security Payload (ESP),&rdquo; January&nbsp;2004.</span><span>)</span></a>, a counter
    block value MUST never be used more than once with a given key.
    This is achieved by having part of the per-record IV determined
    by the record sequence number.
    Although the client and server use the same sequence number space,
    they use different keys and IVs.
    
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1"></a><h3>3.1.1.&nbsp;AES Counter Mode</h3>

<p>
      AES counter mode requires the encryptor and decryptor to share a
      per-record unique counter block.  A given counter block MUST
      never be used more than once with the same key.  For a more
      in-depth discussion of AES-CTR operation, refer to Section 2.1
      of <a class="info" href="#RFC3686">[2]<span> (</span><span class="info">Housley, R., &ldquo;Using Advanced Encryption Standard (AES) Counter Mode With IPsec Encapsulating Security Payload (ESP),&rdquo; January&nbsp;2004.</span><span>)</span></a>.  The following description of
      AES-CTR mode has been adapted from <a class="info" href="#RFC3686">[2]<span> (</span><span class="info">Housley, R., &ldquo;Using Advanced Encryption Standard (AES) Counter Mode With IPsec Encapsulating Security Payload (ESP),&rdquo; January&nbsp;2004.</span><span>)</span></a>.
      
</p>
<p>
      To encrypt a payload with AES-CTR, the encryptor partitions the
      plaintext, PT, into 128-bit blocks.  The final block MAY
      be less than 128 bits.
      
</p>
<p>
      PT = PT[1] PT[2] ... PT[n]
      
</p>
<p>
      Each PT block is XORed with a block of the key stream to
      generate the ciphertext, CT.  The AES encryption of each counter
      block results in 128 bits of key stream.  
      
</p>
<p>
      To construct the counter block, the most significant 48 bits of
      the counter block are set to the 48 low order bits of the
      client_write_IV (for the half-duplex stream originated by the
      client) or the 48 low order bits of the server_write_IV (for the
      half-duplex stream originated by the server.)  The following 64
      bits of the counter block are set to record sequence number, and
      the remaining 16 bits function as the block counter.  The least
      significant bit of the counter block is initially set to one.
      This counter value is incremented by one to generate subsequent
      counter blocks, each resulting in another 128 bits of key
      stream.
      
</p><pre>
       struct {
          case client:
              uint48 client_write_IV;  // low order 48-bits
          case server:
              uint48 server_write_IV;  // low order 48-bits
          uint64 seq_num;
          uint16 blk_ctr;
       } CtrBlk;
</pre>
<p>
      The seq_num and blk_ctr fields of the counter block are
      initialized for each record processed, while the IV is
      initialized immediately after a key calculation is made (key
      calculations are made whenver a TLS/DTLS handshake, either full
      or abbreviated, is executed.)  seq_num is set to the sequence
      number of the record, and blk_ctr is initialized to 1.
      
</p>
<p>
      Note that the block counter does not overflow since the maximum
      TLS/DTLS record size is 14 KB and 16 bits of blk_ctr allow
      the generation of 1MB of keying material per record.
      
</p>
<p>
      The encryption of n plaintext blocks can be summarized as:
      
</p><pre>
      FOR i := 1 to n-1 DO
        CT[i] := PT[i] XOR AES(CtrBlk)
        CtrBlk := CtrBlk + 1
      END
      CT[n] := PT[n] XOR TRUNC(AES(CtrBlk))
</pre>
<p>
      The AES() function performs AES encryption with the fresh key.
      
</p>
<p>   
      The TRUNC() function truncates the output of the AES encrypt
      operation to the same length as the final plaintext block,
      returning the most significant bits.
      
</p>
<p>
      Decryption is similar.  The decryption of n ciphertext blocks
      can be summarized as:
      
</p><pre>
      FOR i := 1 to n-1 DO
        PT[i] := CT[i] XOR AES(CtrBlk)
        CtrBlk := CtrBlk + 1
      END
      PT[n] := CT[n] XOR TRUNC(AES(CtrBlk))
</pre>
<p>
      For TLS, no part of the counter block need be transmitted, since
      the client_write_IV and server_write_IV are derived during the
      key calculation phase, and the record sequence number is
      implicit.
      
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;DTLS</h3>

<p>
    The operation of AES-CTR in DTLS is the same as in TLS, with the
    only difference being the inclusion of the epoch in the counter
    block.  The counter block is constructed as follows for DTLS:
    
</p><pre>
    struct {
       case client:
           uint48 client_write_IV;  // low order 48-bits
       case server:
           uint48 server_write_IV;  // low order 48-bits
       uint16 epoch;
       uint48 seq_num;
       uint16 blk_ctr;
    } CtrBlk;
</pre>
<p>
    The epoch and record sequence number used for generating the
    counter block are extracted from the received record. 
    
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;Padding</h3>

<p>
    Stream ciphers in TLS and DTLS do not require plaintext padding.
    
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;Session Resumption</h3>

<p>
    TLS supports session resumption via caching of session ID's and
    connection parameters on both client and server.  While resumed
    sessions use the same master secret that was originally negotiated,
    a resumed session uses new keys that are derived, in part, using
    fresh client_random and server_random parameters.  As a result
    resumed sessions do not use the same encryption keys or IVs as
    the original session.
    
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;Design Rationale</h3>

<p>
    An alternate design for the construction of the counter block
    would be the use of an explicit 'record tag' (as a substitute for
    the implicit record sequence number) that could potentially be
    generated via an LFSR.  Such a design, however, suffers two major
    drawbacks when used in the TLS or DTLS protocol, without offering
    any significant benefit: (1) in both TLS and DTLS inclusion of
    such a tag would incur a bandwidth cost, (2) all TLS and DTLS
    associations have per-record sequence numbers which can be
    used to ensure counter uniqueness.
    
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;Security Considerations</h3>

<p>
  See Section 7. of <a class="info" href="#RFC3686">[2]<span> (</span><span class="info">Housley, R., &ldquo;Using Advanced Encryption Standard (AES) Counter Mode With IPsec Encapsulating Security Payload (ESP),&rdquo; January&nbsp;2004.</span><span>)</span></a>.
  
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;Maximum Key Lifetime</h3>

<p>
    TLS/DTLS sessions employing AES-CTR MUST be renegotiated before
    sequence numbers repeat.  In the case of TLS, this implies a
    maximum of 2^64 records per session, while for DTLS the maximum is
    2^48 (with the remaining bits reserved for epoch.)
    
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;IANA Considerations</h3>

<p>
  IANA has assigned the following values for AES-CTR mode ciphers:
  
</p>
<p>
   CipherSuite TLS_RSA_WITH_AES_128_CTR_SHA      = { 0xXX, 0xXX };
   CipherSuite TLS_DH_DSS_WITH_AES_128_CTR_SHA   = { 0xXX, 0xXX };
   CipherSuite TLS_DH_RSA_WITH_AES_128_CTR_SHA   = { 0xXX, 0xXX };
   CipherSuite TLS_DHE_DSS_WITH_AES_128_CTR_SHA  = { 0xXX, 0xXX };
   CipherSuite TLS_DHE_RSA_WITH_AES_128_CTR_SHA  = { 0xXX, 0xXX };
   CipherSuite TLS_DH_anon_WITH_AES_128_CTR_SHA  = { 0xXX, 0xXX };
   
</p>
<p>
   CipherSuite TLS_RSA_WITH_AES_256_CTR_SHA      = { 0xXX, 0xXX };
   CipherSuite TLS_DH_DSS_WITH_AES_256_CTR_SHA   = { 0xXX, 0xXX };
   CipherSuite TLS_DH_RSA_WITH_AES_256_CTR_SHA   = { 0xXX, 0xXX };
   CipherSuite TLS_DHE_DSS_WITH_AES_256_CTR_SHA  = { 0xXX, 0xXX };
   CipherSuite TLS_DHE_RSA_WITH_AES_256_CTR_SHA  = { 0xXX, 0xXX };
   CipherSuite TLS_DH_anon_WITH_AES_256_CTR_SHA  = { 0xXX, 0xXX };
  
</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[1]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc2119.txt">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="ftp://ftp.isi.edu/in-notes/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3686">[2]</a></td>
<td class="author-text">Housley, R., &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc3686.txt">Using Advanced Encryption Standard (AES) Counter Mode With IPsec Encapsulating Security Payload (ESP)</a>,&rdquo; RFC&nbsp;3686, January&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-tls-rfc2246-bis">[3]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tls-rfc2246-bis-13.txt">The TLS Protocol Version 1.1</a>,&rdquo; draft-ietf-tls-rfc2246-bis-13 (work in progress), June&nbsp;2005.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nagendra Modadugu</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Stanford University</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">353 Serra Mall</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Stanford, CA  94305</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:nagendra@cs.stanford.edu">nagendra@cs.stanford.edu</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Eric Rescorla</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Network Resonance</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2483 E. Bayshore Rd., #212</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Palo Alto, CA  94303</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ekr@networkresonance.com">ekr@networkresonance.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="bug" align="right"><tr><td class="bug"><a href="#toc" class="link2">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Intellectual Property Statement</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
<h3>Disclaimer of Validity</h3>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS OR IS SPONSORED BY (IF ANY),
THE INTERNET SOCIETY AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM
ALL WARRANTIES,
EXPRESS OR IMPLIED,
INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.</p>
<h3>Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The Internet Society (2006).
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<h3>Acknowledgment</h3>
<p class='copyright'>
Funding for the RFC Editor function is currently provided by the
Internet Society.</p>
</body></html>
